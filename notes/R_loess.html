<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">

  <head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>loess {stats} | inside-R | A Community Site for R</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="/sites/all/themes/rweb/favicon.ico" type="image/x-icon" />
    <link type="text/css" rel="stylesheet" media="all" href="http://www.inside-r.org/sites/default/files/css/css_e7e6890575179c6e19db2a7135928170.css" />
<link type="text/css" rel="stylesheet" media="print" href="http://www.inside-r.org/sites/default/files/css/css_2f8a9213003983ca173e57dd3b576aac.css" />
    <!--[if lte IE 6]><style type="text/css" media="all">@import "/sites/all/themes/rweb/css/ie6.css";</style><![endif]-->
    <!--[if IE 7]><style type="text/css" media="all">@import "/sites/all/themes/rweb/css/ie7.css";</style><![endif]-->
    <script type="text/javascript" src="http://www.inside-r.org/sites/default/files/js/js_2fb44906c3831b546f6f8f2a4909f2aa.js"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/","fivestar":{"titleUser":"Your rating: ","titleAverage":"Average: ","feedbackSavingVote":"Saving your vote...","feedbackVoteSaved":"Your vote has been saved.","feedbackDeletingVote":"Deleting your vote...","feedbackVoteDeleted":"Your vote has been deleted."},"custom_search":{"form_target":"_self","solr":1}});
//--><!]]>
</script>
  </head>

  <body class="not-front not-logged-in page-r-doc one-sidebar sidebar-right show-grid">
  
         
    <div id="skip-nav"><a href="#content">Skip to Content</a></div>  
    <div id="page" class="container-12 clearfix">

    <!-- ______________________ HEADER _______________________ -->

  <div id="header">

              <div id="navigation-secondary" class="grid-10 prefix-2 clearfix">
          <ul class="links secondary-links">
                      <li class="first"><a href="/user/login">log in</a></li>
                      <li class="last"><a href="/rss">rss</a></li>
          </ul>
      </div><!-- /#navigation-secondary -->
      
    <div class="header-row clearfix">

      <div id="logo" class="grid-2">
        <a id="logo" href="/" title="inside-r home" rel="home nofollow"><img src="/sites/all/themes/rweb/images/logo.png" alt="inside-R logo" /></a>
      </div> <!-- /logo -->

              <div id="navigation-primary" class=" grid-10 menu with-main-menu with-sub-menu">
          <ul id="primary" class="links main-menu"><li class="menu-279 first"><a href="/blogs" title="R blogs and news">Blogs</a></li>
<li class="menu-3022 active"><a href="/r-doc" title="R language documentation" class="active">R Language</a></li>
<li class="menu-2815"><a href="/packages" title="Crantastic R packages">R Packages</a></li>
<li class="menu-2897"><a href="/howto" title="Tips and tricks about R">How to</a></li>
<li class="menu-3117"><a href="/pretty-r" title="Pretty R syntax highlighter">Pretty R</a></li>
<li class="menu-3194 last"><a href="/download" title="Download R now">Get R</a></li>
</ul>        </div> <!-- /navigation -->
      
    </div><!-- /header-row -->

    <div class="header-row clearfix">

              <div id="tagline" class="grid-6"><div id="tagline-inner">A Community Site for R – Sponsored by Revolution Analytics</div></div>
      
              <div id="search-box" class="grid-6"><div id="search-box-inner">
          <form action="/r-doc/stats/loess"  accept-charset="UTF-8" method="post" id="search-theme-form" class="search-form">
<div><div id="search" class="container-inline">
  <div class="form-item" id="edit-search-theme-form-1-wrapper">
 <input type="text" maxlength="128" name="search_theme_form" id="edit-search-theme-form-1" size="15" value="" class="form-text cleardefault" />
</div>
<fieldset class="custom_search-popup"></fieldset>
<input type="submit" name="op" id="edit-submit-1" value="GO"  class="form-submit" />
<input type="hidden" name="form_build_id" id="form-bab897e7737054c02036d274be424b1f" value="form-bab897e7737054c02036d274be424b1f"  />
<input type="hidden" name="form_id" id="edit-search-theme-form" value="search_theme_form"  />
<input type="hidden" name="default_text" id="edit-default-text-1" value=""  class="default-text" />
</div>

</div></form>
        </div></div> <!-- /#search-box -->
      
    </div><!-- /header-row -->
    
      <div id="masthead" class="grid-12 clearfix">
        <img src="/sites/all/themes/rweb/images/masthead.jpg" alt="RWeb masthead" />
      </div>

  </div><!-- /#header -->

    <!-- ______________________ MAIN _______________________ -->

    <div id="main" class="grid-9 clearfix">
    
      <div id="content">
        <div id="content-inner" class="inner column center">

          
                      <div id="content-header">

              <div class="breadcrumb"><a href="/">Home</a> » <a href="/r-doc">Language reference</a> » loess {stats}</div>
                              <h1 class="title">loess {stats}</h1>
              
              
               

              
            </div> <!-- /#content-header -->
          
          <div id="content-area">
            <ul class="tabs primary">

</ul>
<div id="node-36928" class="node node-rdoc clear-block">



  <div class="meta">
  
    </div>

  <div class="content">
  
    <div class="field field-type-text field-field-sub-title">
    <div class="field-items">
            <div class="field-item odd">
                    Local Polynomial Regression Fitting        </div>
        </div>
</div>

    <div class="rdoc-meta">
      <div class="field field-type-text field-field-package">
      <div class="field-label">Package:&nbsp;</div>
    <div class="field-items">
            <div class="field-item odd">
                    stats        </div>
        </div>
</div>
      <div class="field field-type-text field-field-r-release">
      <div class="field-label">Version:&nbsp;</div>
    <div class="field-items">
            <div class="field-item odd">
                    R 2.15.3        </div>
        </div>
</div>
    </div><!-- /rdoc-meta -->

    <div class="rdoc-content">
<div class="rdoc-description">
<h3>Description</h3>
<p>Fit a polynomial surface determined by one or more numerical   predictors, using local fitting.
</p></div>
<div class="rdoc-usage">
<h3>Usage</h3>
<pre class="rdoc-monospace">
loess(formula, data, weights, subset, na.action, model = FALSE,
      span = 0.75, enp.target, degree = 2,
      parametric = FALSE, drop.square = FALSE, normalize = TRUE,
      family = c("gaussian", "symmetric"),
      method = c("loess", "model.frame"),
      control = loess.control(...), ...)
</pre></div>
<div class="rdoc-arg-list">
<h3>Arguments</h3>
<dl class="rdoc-args">
<dt>formula</dt>
<dd>a formula specifying the numeric response and     one to four numeric predictors (best specified via an interaction,     but can also be specified additively).  Will be coerced to a formula     if necessary.</dd>
<dt>data</dt>
<dd>an optional data frame, list or environment (or object     coercible by <span class="geshifilter"><code class="r geshifilter-r"><a href="http://inside-r.org/r-doc/base/as.data.frame"><span style="color: #003399; font-weight: bold;">as.data.frame</span></a></code></span> to a data frame) containing     the variables in the model.  If not found in <span class="geshifilter"><code class="r geshifilter-r"><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a></code></span>, the     variables are taken from <span class="geshifilter"><code class="r geshifilter-r"><a href="http://inside-r.org/r-doc/base/environment"><span style="color: #003399; font-weight: bold;">environment</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/formula"><span style="color: #003399; font-weight: bold;">formula</span></a><span style="color: #009900;">&#41;</span></code></span>,     typically the environment from which <span class="geshifilter"><code class="r geshifilter-r"><a href="http://inside-r.org/r-doc/stats/loess"><span style="color: #003399; font-weight: bold;">loess</span></a></code></span> is called.</dd>
<dt>weights</dt>
<dd>optional weights for each case.</dd>
<dt>subset</dt>
<dd>an optional specification of a subset of the data to be     used.</dd>
<dt>na.action</dt>
<dd>the action to be taken with missing values in the     response or predictors.  The default is given by     <span class="geshifilter"><code class="r geshifilter-r"><a href="http://inside-r.org/r-doc/base/getOption"><span style="color: #003399; font-weight: bold;">getOption</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;na.action&quot;</span><span style="color: #009900;">&#41;</span></code></span>.</dd>
<dt>model</dt>
<dd>should the model frame be returned?</dd>
<dt>span</dt>
<dd>the parameter &alpha; which controls the degree of     smoothing.</dd>
<dt>enp.target</dt>
<dd>an alternative way to specify <span class="geshifilter"><code class="r geshifilter-r">span</code></span>, as the     approximate equivalent number of parameters to be used.</dd>
<dt>degree</dt>
<dd>the degree of the polynomials to be used, normally 1 or     2. (Degree 0 is also allowed, but see the &lsquo;Note&rsquo;.)</dd>
<dt>parametric</dt>
<dd>should any terms be fitted globally rather than     locally?  Terms can be specified by name, number or as a logical     vector of the same length as the number of predictors.</dd>
<dt>drop.square</dt>
<dd>for fits with more than one predictor and     <span class="geshifilter"><code class="r geshifilter-r">degree = <span style="color: #cc66cc;">2</span></code></span>, should the quadratic term be dropped for particular     predictors?  Terms are specified in the same way as for     <span class="geshifilter"><code class="r geshifilter-r">parametric</code></span>.</dd>
<dt>normalize</dt>
<dd>should the predictors be normalized to a common scale     if there is more than one?  The normalization used is to set the     10% trimmed standard deviation to one.  Set to false for spatial     coordinate predictors and others know to be a common scale.</dd>
<dt>family</dt>
<dd>if <span class="geshifilter"><code class="r geshifilter-r"><span style="color: #0000ff;">&quot;gaussian&quot;</span></code></span> fitting is by least-squares, and if     <span class="geshifilter"><code class="r geshifilter-r"><span style="color: #0000ff;">&quot;symmetric&quot;</span></code></span> a re-descending M estimator is used with Tukey's     biweight function.</dd>
<dt>method</dt>
<dd>fit the model or just extract the model frame.</dd>
<dt>control</dt>
<dd>control parameters: see <span class="geshifilter"><code class="r geshifilter-r"><a href="http://inside-r.org/r-doc/stats/loess.control"><span style="color: #003399; font-weight: bold;">loess.control</span></a></code></span>.</dd>
<dt>...</dt>
<dd>control parameters can also be supplied directly.</dd>
</dl>
</div>
<div class="rdoc-details">
<h3>Details</h3>
<p>Fitting is done locally.  That is, for the fit at point x, the   fit is made using points in a neighbourhood of x, weighted by   their distance from x (with differences in &lsquo;parametric&rsquo;   variables being ignored when computing the distance).  The size of the   neighbourhood is controlled by &alpha; (set by <span class="geshifilter"><code class="r geshifilter-r">span</code></span> or   <span class="geshifilter"><code class="r geshifilter-r">enp.target</code></span>).  For &alpha; &lt; 1, the   neighbourhood includes proportion &alpha; of the points,   and these have tricubic weighting (proportional to (1 - (dist/maxdist)^3)^3).  For   &alpha; > 1, all points are used, with the   &lsquo;maximum distance&rsquo; assumed to be &alpha;^(1/p)   times the actual maximum distance for p explanatory variables.</p>
<p>  For the default family, fitting is by (weighted) least squares.  For   <span class="geshifilter"><code class="r geshifilter-r"><a href="http://inside-r.org/r-doc/stats/family"><span style="color: #003399; font-weight: bold;">family</span></a>=<span style="color: #0000ff;">&quot;symmetric&quot;</span></code></span> a few iterations of an M-estimation   procedure with Tukey's biweight are used.  Be aware that as the initial   value is the least-squares fit, this need not be a very resistant fit.</p>
<p>  It can be important to tune the control list to achieve acceptable   speed.  See <span class="geshifilter"><code class="r geshifilter-r"><a href="http://inside-r.org/r-doc/stats/loess.control"><span style="color: #003399; font-weight: bold;">loess.control</span></a></code></span> for details.
</p></div>
<div class="rdoc-arg-list">
<h3>Values</h3>
<p>An object of class <span class="geshifilter"><code class="r geshifilter-r"><span style="color: #0000ff;">&quot;loess&quot;</span></code></span>.
</p></div>
<div class="rdoc-references">
<h3>References</h3>
<p>W. S. Cleveland, E. Grosse and W. M. Shyu (1992) Local regression   models. Chapter 8 of <em>Statistical Models in S</em> eds J.M. Chambers   and T.J. Hastie, Wadsworth &amp; Brooks/Cole.
</p></div>
<div class="rdoc-note">
<h3>Note</h3>
<p>As this is based on <span class="geshifilter"><code class="r geshifilter-r">cloess</code></span>, it is similar to but not identical to   the <span class="geshifilter"><code class="r geshifilter-r"><a href="http://inside-r.org/r-doc/stats/loess"><span style="color: #003399; font-weight: bold;">loess</span></a></code></span> function of S.  In particular, conditioning is not   implemented.</p>
<p>  The memory usage of this implementation of <span class="geshifilter"><code class="r geshifilter-r"><a href="http://inside-r.org/r-doc/stats/loess"><span style="color: #003399; font-weight: bold;">loess</span></a></code></span> is roughly   quadratic in the number of points, with 1000 points taking about 10Mb.</p>
<p>  <span class="geshifilter"><code class="r geshifilter-r">degree = <span style="color: #cc66cc;">0</span></code></span>, local constant fitting, is allowed in this   implementation but not documented in the reference.  It seems very little   tested, so use with caution.
</p></div>
<div class="rdoc-seealso">
<h3>See Also</h3>
<p><span class="geshifilter"><code class="r geshifilter-r"><a href="http://inside-r.org/r-doc/stats/loess.control"><span style="color: #003399; font-weight: bold;">loess.control</span></a></code></span>,   <span class="geshifilter"><code class="r geshifilter-r">predict.loess</code></span>.</p>
<p>  <span class="geshifilter"><code class="r geshifilter-r"><a href="http://inside-r.org/r-doc/stats/lowess"><span style="color: #003399; font-weight: bold;">lowess</span></a></code></span>, the ancestor of <span class="geshifilter"><code class="r geshifilter-r"><a href="http://inside-r.org/r-doc/stats/loess"><span style="color: #003399; font-weight: bold;">loess</span></a></code></span> (with   different defaults!).
</p></div>
<div class="rdoc-examples">
<h3>Examples</h3>
<p><div class="geshifilter"><pre class="r geshifilter-r" style="font-family:monospace;">cars.lo <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/loess"><span style="color: #003399; font-weight: bold;">loess</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dist"><span style="color: #003399; font-weight: bold;">dist</span></a> <span style="">~</span> speed<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/datasets/cars"><span style="color: #003399; font-weight: bold;">cars</span></a><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/stats/predict"><span style="color: #003399; font-weight: bold;">predict</span></a><span style="color: #009900;">&#40;</span>cars.lo<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">&#40;</span>speed = <a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399; font-weight: bold;">seq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">5</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">30</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> se = <span style="color: #000000; font-weight: bold;">TRUE</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># to allow extrapolation</span>
cars.lo2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/loess"><span style="color: #003399; font-weight: bold;">loess</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dist"><span style="color: #003399; font-weight: bold;">dist</span></a> <span style="">~</span> speed<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/datasets/cars"><span style="color: #003399; font-weight: bold;">cars</span></a><span style="color: #339933;">,</span>
  <a href="http://inside-r.org/r-doc/boot/control"><span style="color: #003399; font-weight: bold;">control</span></a> = <a href="http://inside-r.org/r-doc/stats/loess.control"><span style="color: #003399; font-weight: bold;">loess.control</span></a><span style="color: #009900;">&#40;</span>surface = <span style="color: #0000ff;">&quot;direct&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/stats/predict"><span style="color: #003399; font-weight: bold;">predict</span></a><span style="color: #009900;">&#40;</span>cars.lo2<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">&#40;</span>speed = <a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399; font-weight: bold;">seq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">5</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">30</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> se = <span style="color: #000000; font-weight: bold;">TRUE</span><span style="color: #009900;">&#41;</span></pre></div>
</p></div>
<div class="rdoc-author">
<h3>Author(s)</h3>
<p>B. D. Ripley, based on the <span class="geshifilter"><code class="r geshifilter-r">cloess</code></span> package of Cleveland,   Grosse and Shyu.
</p></div>
<div class="rdoc-license">
<p>
Documentation reproduced from R 2.15.3. License: <a href="http://www.r-project.org/Licenses/GPL-2">GPL-2</a>.
</p>
</div>
</div>

  </div><!-- /content -->

  <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>          </div> <!-- /#content-area -->

          
          </div>
        </div> <!-- /content-inner /content -->

      </div> <!-- /main -->

      <!-- ______________________ RIGHT SIDEBAR _______________________ -->

              <div id="right-sidebar" class="column sidebar grid-3 clearfix">
          <div id="right-sidebar-inner" class="inner">
              <div id="block-custom_search_blocks-2" class="clear-block block block-custom_search_blocks ">


  <div class="block-inner">

          <h3 class="title block-title">Search Language Reference</h3>
    
    <div class="content">
      <form action="/r-doc/stats/loess"  accept-charset="UTF-8" method="post" id="custom-search-blocks-form-2" class="search-form">
<div><div class="form-item" id="edit-custom-search-blocks-form-2-1-wrapper">
 <label class="element-invisible" for="edit-custom-search-blocks-form-2-1">Search this site: </label>
 <input type="text" maxlength="128" name="custom_search_blocks_form_2" id="edit-custom-search-blocks-form-2-1" size="15" value="" title="Enter the terms you wish to search for." class="form-text  custom-search-default-value custom-search-box" />
</div>
<fieldset class="custom_search-popup"></fieldset>
<input type="hidden" name="custom_search_types" id="edit-custom-search-types" value="c-rdoc"  class="custom-search-selector custom-search-types" />
<input type="hidden" name="delta" id="edit-delta" value="2"  />
<input type="hidden" name="form_build_id" id="form-82f4a3e7c11de539884ed28332162cd1" value="form-82f4a3e7c11de539884ed28332162cd1"  />
<input type="hidden" name="form_id" id="edit-custom-search-blocks-form-2" value="custom_search_blocks_form_2"  />
<input type="hidden" name="default_text" id="edit-default-text" value=""  class="default-text" />
<input type="submit" name="op" id="edit-submit" value="GO"  class="form-submit" />

</div></form>
    </div>

    
  </div> <!-- /block-inner -->
</div> <!-- /block -->              <div id="block-block-5" class="clear-block block block-block ">


  <div class="block-inner">

          <h3 class="title block-title">About Language Reference</h3>
    
    <div class="content">
      <p>This is a collection of the help pages from every function and dataset in the latest version of R (base and recommended packages). Add your comments to the page to offer tips for using these functions, or expand on the documentation. Your comments are tagged with the current R version number, and will be preserved when these pages are updated with the next R release.</p>
<p>The URLs for these pages are stable, in the format:<br /> <a href="http://www.inside-r.org/r-doc/PACKAGE/FUNCTION" title="http://www.inside-r.org/r-doc/PACKAGE/FUNCTION">http://www.inside-r.org/r-doc/PACKAGE/FUNCTION</a></p>
<p>Feel free to link to them from other pages.</p>
    </div>

    
  </div> <!-- /block-inner -->
</div> <!-- /block -->  <div id="block-block-2" class="clear-block block block-block ">


  <div class="block-inner">

          <h3 class="title block-title">About inside-R.org</h3>
    
    <div class="content">
      <p>inside-R.org is a collection of resources about the open-source <a href="http://www.r-project.org" target="_blank">R Project</a> for the R Statistics Community. This site is sponsored by Revolution Analytics.</p>
<p>Follow <a href="http://twitter.com/inside_R" target="_blank">@inside_R</a> on Twitter for updates about this site.</p>
<p>If you have questions or ideas for the site, please send us an email at <a href="mailto:community@inside-R.org">community@inside-R.org</a>.</p>
    </div>

    
  </div> <!-- /block-inner -->
</div> <!-- /block -->  <div id="block-block-3" class="clear-block block block-block ">


  <div class="block-inner">

          <h3 class="title block-title">Information about R</h3>
    
    <div class="content">
      <ul>
<li><a href="/what-is-r">What is R?</a></li>
<li><a href="/why-use-r">Why use R?</a></li>
<li><a href="/r-resources-web">Resources for R</a></li>
</ul>
    </div>

    
  </div> <!-- /block-inner -->
</div> <!-- /block -->          </div> <!-- /sidebar-right-inner -->
        </div> <!-- /sidebar-right -->
       

    </div> <!-- /page -->

      <!-- ______________________ FOOTER _______________________ -->

              <div id="footer" class="container-12 clearfix">
          <div class="footer-menu">
              <div id="block-menu-menu-footer" class="clear-block block block-menu ">


  <div class="block-inner">

    
    <div class="content">
      <ul class="menu"><li class="leaf first"><a href="/contact" title="">Contact us</a></li>
<li class="leaf last"><a href="/terms-and-conditions" title="Terms and conditions">Terms and conditions</a></li>
</ul>    </div>

    
  </div> <!-- /block-inner -->
</div> <!-- /block -->          </div>
        </div> <!-- /footer -->
      
        <script src="http://munchkin.marketo.net/munchkin.js" type="text/javascript"></script> <script>mktoMunchkin("224-FMR-259");</script>

        <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      try { var pageTracker = _gat._getTracker("UA-6984166-8"); pageTracker._trackPageview(); } catch(err) {}
    </script>

      </body>
</html>